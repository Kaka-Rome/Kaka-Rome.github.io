<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kaka's ArtFolio</title>
  <link rel="icon" type="image/x-icon" href="./assets/img/logo/logo-icon.ico">

  <!-- <link rel="stylesheet" href="/assets/css/style-for-old-browser.css"> -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet">
  <script src="https://unpkg.com/scrollreveal@4.0.0/dist/scrollreveal.min.js"></script>

</head>
<body>
  <nav class="nav" id="navbar">
    <div class="nav-brand">
      <img src="assets/img/logo/logo.svg" alt="Logo">
    </div>
    <div id="menu-toggle">
      <input type="checkbox">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <div class="nav-content" id="nav-content">
      <ul class="nav-menu" id="nav-menu">
        <li class="nav-item"><a href="#illustration">Illustration</a></li>
        <li class="nav-item"><a href="#about">About</a></li>
        <li class="nav-item"><a href="#contact">Contact</a></li>
      </ul>
    </div>
  </nav>

  <section class="illustration-section" id="illustration">
    <h1 class="display">Feature Works</h1>
    <div class="gallery-wrapper">
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x333/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x333">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
      <div class="item-gallery">
        <img src="https://dummyimage.com/500x750/25282A/e4e4e2&text=+++Coming+Soon+++" alt="500x750">
        <div class="overlay">
          View Image
        </div>
      </div>
    </div>
  </section>

  <section class="about-section" id="about">
    <h1 class="display">About</h1>
    <img class="img-profile" src="/assets/img/about/profile.jpeg" alt="profile-img">
    <p id="about-description">Hey! I'm Kaka from West Java, Indonesia. I started designing vector art in 2020, creating pieces for wall décor, mug prints, stickers, and wood prints. I can do all sorts of vector work, like animals, people, and automotive. And also make illustrations for various things like t-shirts and posters, etc. I'm excited to work with brands that share my vibes and I am open to long-term partnerships. If you like my work or have any questions, please feel free to reach out by filling in the contact form and let's connect!</p>
    <div class="social-media">
      <div class="social-link"><a id="fiverr" href="#"><i class="fivver-ico"></i></a></div>
      <div class="social-link"><a id="cara" href="#"><i class="cara-ico"></i></a></div>
      <div class="social-link"><a id="upwork" href="#"><i class="upwork-ico"></i></a></div>
      <div class="social-link"><a id="behance" href="#"><i class="behance-ico"></i></a></div>
      <div class="social-link"><a id="thumblr" href="#"><i class="thumblr-ico"></i></a></div>
      <div class="social-link"><a id="pinterest" href="#"><i class="ri-pinterest-fill"></i></a></div>
    </div>
  </section>

  <section class="contact-section" id="contact">
    <h1 class="display">Contact</h1>
    <div></div>
    <div class="contact-content">
      <p>Hit me up on WhatsApp anytime!</p>
      <textarea name="message" id="message" placeholder="Type your message here.."></textarea>
      <button type="button" id="button-whatsapp"><i class="ri-whatsapp-line"></i> Send Message</button>
      <a style="display: none;" href="#" id="whatsapp"></a>
    </div>
    <div class="contact-side-content">
      <div class="other-contact-content">
        <p>Also on:</p>
        <ul>
          <li><a id="email" href="#"><i class="ri-mail-fill"></i><span>rommy@gmail.com</span></a></li>
          <li><a id="instagram" href="#"><i class="ri-instagram-fill"></i><span>@rommy-instagram</a></span></li>
          <li><a id="facebook" href="#"><i class="ri-facebook-circle-fill"></i><span>@rommy-facebook</a></span></li>
          <li><a id="telegram" href="#"><i class="ri-telegram-fill"></i><span>@rommy-telegram</a></span></li>
        </ul>
      </div>
      <div class="payment-content">
        <p>Payment Method List:</p>
        <div class="payment-list">
          <div class="payment-item"><img src="assets/img/logo/PayPal.svg" alt="paypal"></div>
          <div class="payment-item"><img src="assets/img/logo/Gopay.svg" alt="Gopay_logo.svg"></div>
          <div class="payment-item"><img src="assets/img/logo/Dana.svg" alt="Logo_dana_blue.svg"></div>
          <div class="payment-item"><img src="assets/img/logo/BankCentralAsia.svg" alt="Bank_Central_Asia.svg"></div>
          <div class="payment-item"><img src="assets/img/logo/BankBRI.svg" alt="BANK_BRI_logo.svg"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- ------------------------------------------ Modal ------------------------------------------ -->
  <div class="modal">
    <div class="modal-dialog">
    </div>
    <div class="modal-content">
      <div class="modal-body">
        <div class="main-content">
          <h4>Artwork-4</h4>
          <div class="img-container">
            <img id="img-modal" src="./assets/img/illustrations/4.jpeg" alt="Artwork-4">
            <a href="#" id="pop-img" class="button"><i class="ri-external-link-line"></i></a>
          </div>
        </div>
        <div class="side-content">
          <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis sollicitudin eu magna id pretium. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
          </p>
          <div class="modal-nav">
            <button type="button" id="img-prev"><i class="ri-arrow-left-line"></i></button>
            <div class="img-info" id="img-info">
              <span>4</span> of <span>8</span>
            </div>
            <button type="button" id="img-next"><i class="ri-arrow-right-line"></i></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="copyright">© <span>2020</span> Kaka Rome. All Rights Reserved.</div>
    <div class="made-by">
      Made by <a href="https://github.com/randy-ar" target="_blank" ><i class="ri-github-line"></i> randy-ar</a>
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>

  <script>
    const config_path = `${window.location.origin}/config/index.json`;
    const image_detail_path = `${window.location.origin}/config/image_detail.json`;
    var image_details = '';
    var current_image_index = -1;
    const origin = window.location.origin;

    function check_browser_compatibility() {
      var nVer = navigator.appVersion;
      var nAgt = navigator.userAgent;
      var browserName  = navigator.appName;
      var fullVersion  = ''+parseFloat(navigator.appVersion); 
      var majorVersion = parseInt(navigator.appVersion,10);
      var nameOffset,verOffset,ix;

      // In Opera, the true version is after "OPR" or after "Version"
      if ((verOffset=nAgt.indexOf("OPR"))!=-1) {
        browserName = "Opera";
        fullVersion = nAgt.substring(verOffset+4);
        if ((verOffset=nAgt.indexOf("Version"))!=-1) 
          fullVersion = nAgt.substring(verOffset+8);
      }
      // In MS Edge, the true version is after "Edg" in userAgent
      else if ((verOffset=nAgt.indexOf("Edg"))!=-1) {
        browserName = "Microsoft Edge";
        fullVersion = nAgt.substring(verOffset+4);
      }
      // In MSIE, the true version is after "MSIE" in userAgent
      else if ((verOffset=nAgt.indexOf("MSIE"))!=-1) {
        browserName = "Microsoft Internet Explorer";
        fullVersion = nAgt.substring(verOffset+5);
      }
      // In Chrome, the true version is after "Chrome" 
      else if ((verOffset=nAgt.indexOf("Chrome"))!=-1) {
        browserName = "Chrome";
        fullVersion = nAgt.substring(verOffset+7);
      }
      // In Safari, the true version is after "Safari" or after "Version" 
      else if ((verOffset=nAgt.indexOf("Safari"))!=-1) {
        browserName = "Safari";
        fullVersion = nAgt.substring(verOffset+7);
        if ((verOffset=nAgt.indexOf("Version"))!=-1) 
          fullVersion = nAgt.substring(verOffset+8);
      }
      // In Firefox, the true version is after "Firefox" 
      else if ((verOffset=nAgt.indexOf("Firefox"))!=-1) {
        browserName = "Firefox";
        fullVersion = nAgt.substring(verOffset+8);
      }
      // In most other browsers, "name/version" is at the end of userAgent 
      else if ( (nameOffset=nAgt.lastIndexOf(' ')+1) < 
                  (verOffset=nAgt.lastIndexOf('/')) ) {
        browserName = nAgt.substring(nameOffset,verOffset);
        fullVersion = nAgt.substring(verOffset+1);
        if (browserName.toLowerCase()==browserName.toUpperCase()) {
          browserName = navigator.appName;
        }
      }
      // trim the fullVersion string at semicolon/space if present
      if ((ix=fullVersion.indexOf(";"))!=-1)
        fullVersion=fullVersion.substring(0,ix);
      if ((ix=fullVersion.indexOf(" "))!=-1)
        fullVersion=fullVersion.substring(0,ix);

      majorVersion = parseInt(''+fullVersion,10);
      if (isNaN(majorVersion)) {
        fullVersion  = ''+parseFloat(navigator.appVersion); 
        majorVersion = parseInt(navigator.appVersion,10);
      }

      if(browserName == 'Chrome' && majorVersion >= 86 && majorVersion <= 104){
        if(majorVersion >= 86 && majorVersion <= 104){
          $('.gallery-wrapper').addClass('v86');
        }
      }
    }

    function read_config(config_path) {
      return new Promise((resolve, reject) => {
        axios.get(config_path)
          .then(data => data.data)
          .then(config => {
            if(config != null){
              return resolve(config);
            }
          }).catch(err => {
            return reject(err);
          });
      });  
    }

    function read_image_detail(config_path) {
      return new Promise((resolve, reject) => {
        if(image_details == ''){
          axios.get(image_detail_path)
            .then(data => data.data)
            .then(data => {
              if(data != null){
                return resolve(data);
              }
            }).catch(err => {
              return reject(err);
            });
        }else{
          return resolve(image_details);
        }
      });
    }

    function render_image(config_file){
      $('.gallery-wrapper').html('');
      return new Promise((resolve, reject) => {
        try {
          let html = ``;
          config_file.config.illustrations.images.forEach(image => {
            html += `
            <div class="item-gallery">
              <img src="${origin}${config_file.config.illustrations.original_path}/thumbnails/${image.filename}" alt="${image.name}">
              <div class="overlay">
                <span>
                  ${image.name} <i class="ri-share-box-line"></i>
                </span>
              </div>
            </div>
            `;
          });
          // Resolve condition
          $('.gallery-wrapper').html(html).ready(() => {
            resolve("finish render");
          });
        } catch (err) {
          reject(err);
        }
      });
    }

    function filter_link_to_username(link){
      if (link.startsWith("mailto: ")) {
        return link.replace("mailto: ", "");
      } else if (link.startsWith("https://www.instagram.com/")) {
        return link.replace("https://www.instagram.com/", "@");
      } else if (link.startsWith("https://www.facebook.com/")) {
        return link.replace("https://www.facebook.com/", "@");
      } else if (link.startsWith("https://t.me/")) {
        return link.replace("https://t.me/", "@");
      } else {
        return link;
      }
    }

    function render_link(config_file){
      return new Promise((resolve, reject) => {
        try {
          config_file.config.links.forEach(item => {
            $(`#${item.type}`).attr({
              "href": item.link,
              "target": '__blank'
            });
            $(`#${item.type} span`).html(`${filter_link_to_username(item.link)}`);
          });
          resolve("finish render");
        } catch (error) {
          reject(error)
        }
      });
    }

    function render_image_modal(image_details, img_name = '', idx = -1){
      return new Promise((resolve, reject) => {
        $('#img-next').removeClass('disabled');
        $('#img-prev').removeClass('disabled');
        let index = -1;
        if(img_name != ''){
          index = image_details.images.findIndex(o => o.name == img_name);
        }
        if(idx > -1){
          index = idx;
        }
        console.log(img_name);
        console.log(index);
        console.log(image_details);
        if(index > -1){
          let img = image_details.images[index];
          // alert('show');
          if(index == image_details.total_image - 1){
            $('#img-next').addClass('disabled');
          }
          if(index == 0){
            $('#img-prev').addClass('disabled');
          }
          $('#img-modal').attr('src', `${origin}${image_details.original_path}/${img.filename}`);
          $('#img-modal').attr('alt', `${img.name}`);
          $('#pop-img').attr('href', `${origin}${image_details.original_path}/${img.filename}`);
          $('.modal-body p').html(img.description);
          $('.modal-body h4').html(img.name);
          $('.modal-body .img-info').html(`${index + 1} of ${image_details.total_image}`);
          $('#img-modal')
            .on("load", function () {
              return resolve(index);
            }).on("error", function () {
              return reject('failed  render');
            });
        }else{
          return reject('Image not found');
        }
      });
    }

    async function run_read_config(config_path) {
      let config = await read_config(config_path);
      return config;
    }

    async function run_render_image(config_file){
      let render = await render_image(config_file);
      return render;
    }

    async function run_render_link(config_file){
      let render = await render_link(config_file);
      return render;
    }

    async function run_read_image_detail(image_detail_path){
      let image_detail = await read_image_detail(image_detail_path);
      return image_detail;
    }

    async function run_render_image_modal(image_details, img_name = '', idx = -1){
      // Return founded index;
      let index = await render_image_modal(image_details, img_name, idx);
      return index;
    }


    // ================================== Read Config File ==================================
    let result = run_read_config(config_path);
    result.then((config_file) => {
      console.log(config_file);
      $(function(){
        check_browser_compatibility();
        let render_illust = run_render_image(config_file);

        render_illust.then(() => {
          // ================================== Scroll reveal ==================================
          const sr = ScrollReveal({
            origin: 'top',
            distance: '60px',
            duration: 2500,
            delay: 400,
          });

          ScrollReveal().reveal('.item-gallery', { 
            delay: 300, 
            easing: 'ease-out', 
            duration: 300, 
            scale: .8,
            reset: true
          });

          sr.reveal('.about-section');
          sr.reveal('.contact-section h1', {origin: 'left'});
          sr.reveal('.contact-section .contact-content', {origin: 'left'});
          sr.reveal('.contact-section .contact-side-content', {origin: 'right'});
        }, (err) => {
          console.error(err);
          $('.gallery-wrapper').after(`<p style="text-align: center;"> Illustrations not yet available</p>`);
        });

        // ================================== Item Galllery ==================================
        $('.item-gallery').click(function(e) {
            let img_name = $(this).children('img').attr('alt');
            let image_detail = run_read_image_detail(image_detail_path);
            image_detail.then((details) =>{
              let img_index = run_render_image_modal(details, img_name);
              img_index.then((index) => {
                current_image_index = index;
                $('.modal').addClass('show');
              });
            });
            $('html, body').addClass('hide-scroll');
        });
        $('.modal-dialog').click(function(e) {
          $(this).parent().removeClass('show');
          $('html, body').removeClass('hide-scroll');
        });
        $('#img-next').click(function(){
          let image_detail = run_read_image_detail(image_detail_path);
          let idx = current_image_index + 1;
          image_detail.then((details) =>{
            if(idx < details.total_image && idx > -1){
              let img_index = run_render_image_modal(details, '', idx);
              img_index.then((index) => {
                current_image_index = index;
              });
            }
          });
        });
        $('#img-prev').click(function(){
          let image_detail = run_read_image_detail(image_detail_path);
          let idx = current_image_index - 1;
          image_detail.then((details) =>{
            if(idx < details.total_image && idx > -1){
              let img_index = run_render_image_modal(details, '', idx);
              img_index.then((index) => {
                current_image_index = index;
              });
            }
          });
        });
        $('#pop-img').click(function(e){
            event.preventDefault();
            window.open($(this).attr("href"), "popupWindow", "width=600,height=600,scrollbars=yes");
        });

        // ================================== About ==================================
        $('#about-description').html(config_file.config.about.description);


        // ================================== Navbar ==================================
        window.onscroll = function() {myFunction()};

        var navbar = document.getElementById("navbar");
        var sticky = navbar.offsetTop;

        function myFunction() {
          if (window.pageYOffset >= sticky + 4) {
            navbar.classList.add("sticky")
          } else {
            if(!$('#menu-toggle input').is(':checked')){
              navbar.classList.remove("sticky");
            }
          }
        }
        
        $('#menu-toggle').on('click', ()=>{
          if($('#menu-toggle input').is(':checked')){
            $('#nav-content').addClass('nav-show');
            $('#nav-menu').addClass('nav-menu-show');
            $('#navbar').addClass('sticky');
            $('html, body').addClass('hide-scroll');
          }else{
            $('#nav-content').removeClass('nav-show');
            $('#nav-menu').removeClass('nav-menu-show');
            $('html, body').removeClass('hide-scroll');
          }
        });

        sections  = $('section')
        for(ind in sections){
          section = sections[ind];

          $('a[href^="#'+section.id+'"]').on('click', function (e) {
              e.preventDefault();
              var target = this.hash,
                  $target = $(target);

              console.log($(window).width());
              if($(window).width() < 641){
                $('#menu-toggle input').click(); // Unchecks it
              }

              $('html, body').stop().animate({
                  'scrollTop': $target.offset().top - 100
              }, 400, 'swing', function () {
                  // window.location.hash = target;
              });
          });
        }
      });

      // ================================== Links ==================================
      let redered_link = run_render_link(config_file);
      redered_link.then(() => {}, (err) => { console.error(err) })
      $('#button-whatsapp').on("click", (e) => {
        e.preventDefault(); 
        let url = $('#whatsapp').attr("href");
        if($('#message').val() != ""){
          url += `?text=${$('#message').val()}`;
        }
        window.open(url, '_blank')
      });

      // ================================== Footer ==================================
      let currentYear = new Date().getFullYear()
      $('.footer .copyright span').html(currentYear);
    });

  </script>
</body>
</html>